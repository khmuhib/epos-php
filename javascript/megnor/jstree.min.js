!function(p){p.extend(p.fn,{swapClass:function(a,e){var l=this.filter("."+a);return this.filter("."+e).removeClass(e).addClass(a),l.removeClass(a).addClass(e),this},replaceClass:function(a,e){return this.filter("."+a).removeClass(a).addClass(e).end()},hoverClass:function(a){return a=a||"hover",this.hover(function(){p(this).addClass(a)},function(){p(this).removeClass(a)})},heightToggle:function(a,e){a?this.animate({height:"toggle"},a,e):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),e&&e.apply(this,arguments)})},heightHide:function(a,e){a?this.animate({height:"hide"},a,e):(this.hide(),e&&this.each(e))},prepareBranches:function(a){return a.prerendered||(this.filter(":last-child:not(ul)").addClass(c.last),this.filter((a.collapsed?"":"."+c.closed)+":not(."+c.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(a,e){this.filter(":has(>ul):not(:has(>a))").find(">span").click(function(a){e.apply(p(this).next())}).add(p("a",this)).hoverClass(),a.prerendered||(this.filter(":has(>ul:hidden)").addClass(c.expandable).replaceClass(c.last,c.lastExpandable),this.not(":has(>ul:hidden)").addClass(c.collapsable).replaceClass(c.last,c.lastCollapsable),this.prepend('<div class="'+c.hitarea+'"/>').find("div."+c.hitarea).each(function(){var a="";p.each(p(this).parent().attr("class").split(" "),function(){a+=this+"-hitarea "}),p(this).addClass(a)})),this.find("div."+c.hitarea).click(e)},treeview:function(s){if((s=p.extend({cookieId:"treeview"},s)).add)return this.trigger("add",[s.add]);var a;function l(){p(this).parent().find(">.hitarea").swapClass(c.collapsableHitarea,c.expandableHitarea).swapClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().swapClass(c.collapsable,c.expandable).swapClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightToggle(s.animated,s.toggle),s.unique&&p(this).parent().siblings().find(">.hitarea").replaceClass(c.collapsableHitarea,c.expandableHitarea).replaceClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().replaceClass(c.collapsable,c.expandable).replaceClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightHide(s.animated,s.toggle)}s.toggle&&(a=s.toggle,s.toggle=function(){return a.apply(p(this).parent()[0],arguments)}),this.addClass("treeview");var t,e,i,n,r=this.find("li").prepareBranches(s);switch(s.persist){case"cookie":var o=s.toggle;s.toggle=function(){var l;l=[],r.each(function(a,e){l[a]=p(e).is(":has(>ul:visible)")?1:0}),p.cookie(s.cookieId,l.join("")),o&&o.apply(this,arguments)},(e=p.cookie(s.cookieId))&&(t=e.split(""),r.each(function(a,e){p(e).find(">ul")[parseInt(t[a])?"show":"hide"]()}));break;case"location":var d=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()});d.length&&d.addClass("selected").parents("ul, li").add(d.next()).show()}function h(a){return function(){return l.apply(p("div."+c.hitarea,i).filter(function(){return!a||p(this).parent("."+a).length})),!1}}return r.applyClasses(s,l),s.control&&(i=this,n=s.control,p("a:eq(0)",n).click(h(c.collapsable)),p("a:eq(1)",n).click(h(c.expandable)),p("a:eq(2)",n).click(h()),p(s.control).show()),this.bind("add",function(a,e){p(e).prev().removeClass(c.last).removeClass(c.lastCollapsable).removeClass(c.lastExpandable).find(">.hitarea").removeClass(c.lastCollapsableHitarea).removeClass(c.lastExpandableHitarea),p(e).find("li").andSelf().prepareBranches(s).applyClasses(s,l)})}});var c=p.fn.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"};p.fn.Treeview=p.fn.treeview}(jQuery);